<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Circle Clicker â€” full upgrade version</title>
<style>
:root{--bg:#f2f2f2;--card:#fff;--muted:#ddd}
body{margin:0;font-family:Arial,Helvetica,sans-serif;background:var(--bg);color:#111;min-height:100vh;display:flex;gap:10px}
.column{flex:1;padding:12px;box-sizing:border-box}
@media (max-width:900px){body{flex-direction:column}}
#game-column{display:flex;flex-direction:column;align-items:center}
#game-inner{margin-top:80px;width:100%;display:flex;flex-direction:column;align-items:center}
#clicks{font-size:18px;margin:6px 0}
#cps{font-size:14px;margin:3px 0;color:#333}
#game-container{position:relative;width:360px;height:360px;background:transparent}
#click-circle{position:absolute;top:50%;left:50%;width:120px;height:120px;border-radius:50%;background:black;transform:translate(-50%,-50%) scale(1);cursor:pointer;transition:transform 0.08s ease-out}
#cursor-container{position:absolute;top:50%;left:50%;width:0;height:0;transform:translate(-50%,-50%)}
.cursor{position:absolute;width:32px;height:32px;transform-origin:center center;pointer-events:none}
#middle-buttons{display:flex;gap:8px;margin-bottom:8px;flex-wrap:wrap}
#info-display{background:var(--card);padding:10px;border-radius:8px;min-height:200px;max-height:60vh;overflow:auto}
button{background:var(--card);border:1px solid #aaa;padding:7px 10px;border-radius:6px;cursor:pointer}
.panel{background:var(--card);padding:10px;border-radius:8px}
.store-row,.upgrade-row{display:flex;align-items:center;justify-content:space-between;padding:6px;border-radius:6px;margin:6px 0;background:var(--muted)}
.store-left{display:flex;align-items:center;gap:8px}
.smallimg{width:38px;height:38px;object-fit:contain}
.count{min-width:36px;text-align:center}
#popup-bg{display:none;position:fixed;left:0;top:0;width:100%;height:100%;background:rgba(0,0,0,0.6);align-items:center;justify-content:center;z-index:999}
#popup{background:white;color:#111;padding:16px;border-radius:10px;max-width:92%;width:320px}
#popup img{width:48px;height:48px;display:block;margin:0 auto 8px}
.locked{opacity:0.5;pointer-events:none}
.note{font-size:12px;color:#444;margin-top:6px}
</style>
</head>
<body>

<!-- LEFT: Game -->
<div class="column" id="game-column">
  <div id="game-inner">
    <div id="clicks">Clicks: 0</div>
    <div id="cps">CPS: 0.0</div>
    <div id="game-container">
      <div id="click-circle" title="Click me"></div>
      <div id="cursor-container"></div>
    </div>
  </div>
</div>

<!-- MIDDLE: Info -->
<div class="column">
  <div id="middle-buttons">
    <button id="btn-updates">Updates</button>
    <button id="btn-settings">Settings</button>
  </div>
  <div id="info-display"></div>
</div>

<!-- RIGHT: Store -->
<div class="column">
  <div class="panel" id="upgrades-panel">
    <h3>Upgrades</h3>
    <div id="upgrade-list"></div>
  </div>
  <div class="panel" id="store-panel" style="margin-top:12px">
    <h3>Store</h3>
    <div class="store-row" id="store-cursor">
      <div class="store-left">
        <img id="store-cursor-img" class="smallimg" alt="cursor icon">
        <div><strong>Cursor</strong><div style="font-size:12px">A simple cursor for all your simple needs.</div></div>
      </div>
      <div>
        <button id="buy-cursor-btn">Buy</button>
        <div class="count" id="cursor-count">0</div>
      </div>
    </div>
    <div class="store-row" id="store-grandma">
      <div class="store-left">
        <img id="store-grandma-img" class="smallimg" alt="grandma icon">
        <div><strong>Grandma</strong><div style="font-size:12px">Hire these old grandmas to click for you!</div></div>
      </div>
      <div>
        <button id="buy-grandma-btn">Buy</button>
        <div class="count" id="grandma-count">0</div>
      </div>
    </div>
  </div>
</div>

<!-- POPUP -->
<div id="popup-bg" onclick="if(event.target===this) closePopup()">
  <div id="popup" role="dialog" aria-modal="true">
    <img id="popup-icon" alt="">
    <h3 id="popup-title"></h3>
    <div id="popup-desc" style="margin:8px 0"></div>
    <div id="popup-effect" style="font-weight:600;margin-bottom:6px"></div>
    <div>Cost: <span id="popup-cost"></span> clicks</div>
    <div style="display:flex;gap:8px;margin-top:10px;justify-content:center">
      <button id="popup-buy">Buy</button>
      <button onclick="closePopup()">Cancel</button>
    </div>
  </div>
</div>

<script>
const cursorOrbitImg = "https://images.vexels.com/media/users/3/131773/isolated/svg/790c78d39fd853ae72167411aa11d727.svg";
let state = {
  clicks: 0,
  cursors: 0,
  grandmas: 0,
  cursorCost: 15,
  grandmaCost: 100,
  baseCursorCPS: 0.1,
  baseGrandmaCPS: 1,
  multiplier_click: 1,
  multiplier_cursor: 1,
  multiplier_grandma: 1,
  upgrades: []
};

// --- Upgrades List ---
state.upgrades = [
  {id:'rif',name:'Reinforced Index Finger',desc:'Doubles cursor effectiveness.',cost:100,reqType:'cursor',reqCount:1,icon:'https://static.wikia.nocookie.net/cookieclicker/images/d/d2/Plain_cursor.png',bought:false,apply:()=>{state.multiplier_cursor*=2; state.multiplier_click *= 2;}},
  {id:'cream',name:'Carpal Tunnel Prevention Cream',desc:'Doubles cursor effectiveness again.',cost:500,reqType:'cursor',reqCount:1,icon:'https://static.wikia.nocookie.net/cookieclicker/images/0/01/Berrylium_cursor.png',bought:false,apply:()=>{state.multiplier_cursor*=2; state.multiplier_click *= 2;}},
  {id:'ambi',name:'Ambidextrous',desc:'Doubles cursor effectiveness once more.',cost:10000,reqType:'cursor',reqCount:10,icon:'https://static.wikia.nocookie.net/cookieclicker/images/2/2e/Blueberrylium_cursor.png',bought:false,apply:()=>{state.multiplier_cursor*=2; state.multiplier_click *= 2;}},
  {id:'g1',name:'Forwards from grandma',desc:'Doubles grandma effectiveness.',cost:1000,reqType:'grandma',reqCount:1,icon:'https://static.wikia.nocookie.net/cookieclicker/images/0/00/Plain_grandma.png',bought:false,apply:()=>{state.multiplier_grandma*=2}},
  {id:'g2',name:'Steel-plated rolling pins',desc:'Doubles grandma effectiveness again.',cost:5000,reqType:'grandma',reqCount:5,icon:'https://static.wikia.nocookie.net/cookieclicker/images/d/dc/Berrylium_grandma.png',bought:false,apply:()=>{state.multiplier_grandma*=2}},
  {id:'g3',name:'Lubricated dentures',desc:'Doubles grandma effectiveness once more.',cost:50000,reqType:'grandma',reqCount:25,icon:'https://static.wikia.nocookie.net/cookieclicker/images/2/2a/Blueberrylium_grandma.png',bought:false,apply:()=>{state.multiplier_grandma*=2}}
];

// --- Elements ---
const clickCircle = document.getElementById("click-circle");
const clickCountEl = document.getElementById("clicks");
const cpsEl = document.getElementById("cps");
const cursorContainer = document.getElementById("cursor-container");
const upgradeListEl = document.getElementById("upgrade-list");
document.getElementById("store-cursor-img").src = cursorOrbitImg;
document.getElementById("store-grandma-img").src = "https://static.wikia.nocookie.net/cookieclicker/images/a/a0/GrandmaIconTransparent.png";

// --- Display ---
function getCPS(){
  return (state.cursors * state.baseCursorCPS * state.multiplier_cursor) +
         (state.grandmas * state.baseGrandmaCPS * state.multiplier_grandma);
}
function updateDisplay(){
  clickCountEl.textContent = "Clicks: " + Math.floor(state.clicks);
  cpsEl.textContent = "CPS: " + getCPS().toFixed(2);
  document.getElementById("cursor-count").textContent = state.cursors;
  document.getElementById("grandma-count").textContent = state.grandmas;
  document.getElementById("buy-cursor-btn").textContent = `Buy (${state.cursorCost})`;
  document.getElementById("buy-grandma-btn").textContent = `Buy (${state.grandmaCost})`;
  updateUpgradeList();
}

// --- Circle click ---
clickCircle.addEventListener("click",()=>{
  const gain = state.cookiesPerClick * state.multiplier_click;
  state.cookies += gain;
  state.clicks++;

  updateDisplay();

  // Click animation
  clickCircle.style.transform = "translate(-50%, -50%) scale(1.1)";
  setTimeout(() => clickCircle.style.transform = "translate(-50%, -50%) scale(1)", 80);
});


// --- Store logic ---
function buyCursor(){
  if(state.clicks>=state.cursorCost){
    state.clicks-=state.cursorCost;
    state.cursors++;
    state.cursorCost=Math.floor(15*Math.pow(1.15,state.cursors));
    addOrbitingCursor();
    updateDisplay();
  }
}
function buyGrandma(){
  if(state.clicks>=state.grandmaCost){
    state.clicks-=state.grandmaCost;
    state.grandmas++;
    state.grandmaCost=Math.floor(100*Math.pow(1.15,state.grandmas));
    updateDisplay();
  }
}
document.getElementById("buy-cursor-btn").onclick=buyCursor;
document.getElementById("buy-grandma-btn").onclick=buyGrandma;

// --- Cursors orbit ---
function addOrbitingCursor(){
  const img=document.createElement("img");
  img.className="cursor";
  img.src=cursorOrbitImg;
  cursorContainer.appendChild(img);
}
function positionCursors(angleOffset){
  const cursors=[...cursorContainer.children];
  const baseRadius=80;
  const perRing=80;
  let index=0,layer=0;
  while(index<cursors.length){
    const countInRing=Math.min(perRing,cursors.length-index);
    for(let i=0;i<countInRing;i++){
      const node=cursors[index+i];
      const angle=(i/countInRing)*Math.PI*2+angleOffset+layer*0.03;
      const radius=baseRadius+layer*42;
      const x=Math.cos(angle)*radius;
      const y=Math.sin(angle)*radius;
      node.style.left=(x-16)+"px";
      node.style.top=(y-16)+"px";
      node.style.transform=`rotate(${(angle*180/Math.PI)-90}deg)`;
    }
    index+=countInRing;layer++;
  }
}

// --- Passive CPS ---
setInterval(()=>{
  state.clicks+=getCPS()/10;
  updateDisplay();
},100);

// --- Animation ---
let angleOffset=0;
function animate(){
  angleOffset+=0.03;
  positionCursors(angleOffset);
  requestAnimationFrame(animate);
}
animate();

// --- Upgrades ---
function updateUpgradeList(){
  upgradeListEl.innerHTML="";
  state.upgrades.forEach(u=>{
    const ownedCount=state[u.reqType+"s"]||0;
    if(!u.bought && ownedCount>=u.reqCount){
      const row=document.createElement("div");
      row.className="upgrade-row";
      row.innerHTML=`<div class="store-left"><img src="${u.icon}" class="smallimg"><div><strong>${u.name}</strong><div style="font-size:12px">${u.desc}</div></div></div><button>Buy (${u.cost})</button>`;
      row.querySelector("button").onclick=()=>showUpgradePopup(u);
      upgradeListEl.appendChild(row);
    }
  });
}
function showUpgradePopup(u){
  document.getElementById("popup-bg").style.display="flex";
  document.getElementById("popup-icon").src=u.icon;
  document.getElementById("popup-title").textContent=u.name;
  document.getElementById("popup-desc").textContent=u.desc;
  document.getElementById("popup-effect").textContent=`Effect: Doubles ${u.reqType} effectiveness`;
  document.getElementById("popup-cost").textContent=u.cost;
  const buy=document.getElementById("popup-buy");
  buy.onclick=()=>{
    if(state.clicks>=u.cost){
      state.clicks-=u.cost;
      u.bought=true;
      u.apply();
      closePopup();
      updateDisplay();
    }
  };
}
function closePopup(){document.getElementById("popup-bg").style.display="none";}

// --- Info Buttons ---
document.getElementById("btn-updates").onclick=()=>document.getElementById("info-display").innerHTML="<h3>Patch Notes</h3><ul><li>Upgrades restored and fixed!</li><li>Cursors orbit properly.</li><li>Click counter cleaned.</li></ul>";
document.getElementById("btn-settings").onclick=()=>document.getElementById("info-display").innerHTML="<h3>Settings</h3><p>Coming soon...</p>";

updateDisplay();
</script>
</body>
</html>
